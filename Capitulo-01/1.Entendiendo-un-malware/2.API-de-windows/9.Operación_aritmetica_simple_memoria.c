#include <windows.h>
#include <stdio.h>

typedef int (*AddFunc)(int,int );

int main (){
    unsigned char code[]={
        0x55, 
        0x48, 0x89, 0xe5,
        0x89, 0x7d, 0xfc,
        0x89, 0x75, 0xf8, 
        0x8b, 0x55, 0xfc,
        0x8b, 0x45, 0xfc,
        0x01, 0xd0,
        0x5d,
        0xc3

    };

    void* mem= VirtualAlloc(NULL, sizeof(code), MEM_COMMIT| MEM_RESERVE, PAGE_EXECUTE_READWRITE);
    RtlMoveMemory(mem, code, sizeof(code));

    AddFunc add = (AddFunc)mem;

    int result= add(5,3);
    printf("Resultado %d\n", result);

    VirtualFree(mem, 0, MEM_RELEASE);

    return 0;

}